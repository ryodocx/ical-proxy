- コンセプト: 汎用的な構造データ変換システム
  - pullを前提に設計する
  - pushはfluentdやvector的なイメージだが、この逆。
- 拡張可能な設計にする
  - データ入力(取得)層
    - 対応フォーマットを増やせる構造にする。
    - できれば本体に手を加えなくても拡張可能にしたいが。。。
  - OPA/Regoに依る変換層
    - Regoで書くのでなんでもござれ
    - https://openpolicyregistry.io 対応
  - User識別を可能とする認証層
    - JWTでOPA側に情報を引き渡せるようにしたい
    - https://dexidp.io など、OIDC認証連携を前提に組む
    - あくまでもoptional
    - 単に、OIDC認証連携の結果を信頼してToken発行を行う何かがあればよい？
    - JWTの正当性検証は必要
    - queryパラメータに認証情報を入れる前提
- 入力フォーマット
  - ファイル
  - Redmine Issue, Version
  - GitLab issue, Release
  - GitHub issue, Release
  - RSS 1.0
  - RSS 2.0
  - Atom feed
  - StatusPage
    - 特に重視するユースケースにしたい。GrafanaのAnnotation用Datasourceにも。
    - API?
    - Atom feedのUpdateがpublishとおなじになっている件
  - Twitter
  - Mastodon
  - Prometheus AlertManager
  - Calendar
    - External iCalendar
    - 365
    - Google
    - https://connpass.com/
      - https://connpass.com/about/api/
    - その他イベント管理プラットフォーム
    - https://github.com/public-apis/public-apis#calendar
  - 標準フォーマットAPI
    - 任意のデータソース対応するため、一度標準フォーマットを経由するパターン
    - 仕様を公開しておけば、実装は任意の言語・形態で可能になる
  - その他API
    - https://github.com/public-apis/public-apis
    - https://rapidapi.com/hub
    - https://www.postman.com/explore
- 出力フォーマット
  - iCal
  - ~~RSS 2.0~~ Atomだけで十分？
  - Atom feed
  - 標準フォーマット
  - 任意フォーマット
- 独自フォーマット
  - 情報のリスト構造を標準化したい
  - 他のツールでもAPI以外のViewを提供しやすくなるはず
  - 特に https://raycast.com との連携を意識したい
- キャッシュ機構
- K8sフレンドリー
  - helm chart
- iCalのwebビューアー
- 複数イベントソースのアグリゲーション
  - 標準フォーマット経由？
- XMLをOPAで処理する
  - JSON変換が必要
  - https://www.site24x7.com/ja/tools/xml-to-json.html
- JSON Schemaで入力データバリデーション
- 標準出力フォーマット
  - メタデータ, リストメタデータ, アイテムリストを持つ
  - リストメタデータ
    - アイテム数、範囲外アイテムの有無等を示す
    - ソート順
  - フォーマットの型(Kind)がある
    - 単一データのみの単純な構造
    - 時間をもつイベントのリスト
      - 時間 = 日付
      - 時間 = 開始/終了時刻
    - 時間を持たないアイテムのリスト
  - 返却するHTTP StatusCode, Header等の制御をできるようにしたい
- ユースケース
  - リリース予定
    - Redmine issue
  - 新刊情報
    - 技術評論社: https://gihyo.jp/feed
    - オライリー: https://www.oreilly.co.jp/feeds/
  - Connpassのイベント
    - https://connpass.com/api/v1/event/?count=100&series_id=2033&order=2&ym=202212,202211,202210
  - StatusPageの障害履歴 ★Grafana annotationもやりたい
    - https://status.sendgrid.com/history
  - リリース予定日(google calendar)
    - https://kubernetes.io/releases/#upcoming-release
    - https://calendar.google.com/calendar/u/0/embed?src=agst.us_b07popf7t4avmt4km7eq5tk5ao@group.calendar.google.com&pli=1
  - チームメイトの休暇予定
    - 365?
- OPAの実行については、公式イメージを使っても良い
  - https://www.openpolicyagent.org/docs/latest/deployments/
  - プロセス分離されることで構成が複雑化する恐れはある
